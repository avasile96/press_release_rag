from pathlib import Path
from langchain_community.vectorstores import FAISS
from langchain.docstore.document import Document as LCDocument
from src.llm.embeddings import get_embeddings
from src.config.settings import settings

"""
Create the FAISS store from chunks
"""

def build_faiss(chunks: list) -> None:
    emb = get_embeddings()
    lc_docs = [
        LCDocument(page_content=c.text, metadata={"doc_id": c.doc_id, **c.meta})
        for c in chunks
    ]
    vs = FAISS.from_documents(lc_docs, emb)
    settings.vectorstore_dir.mkdir(parents=True, exist_ok=True)
    vs.save_local(str(settings.vectorstore_dir))
